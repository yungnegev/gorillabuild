## Gorilla Progress — PRD

### One-liner
Приложение, где ты быстро логируешь силовые тренировки, видишь графики 1RM, сравниваешь 1RM с друзьями (абсолют и \(1RM/масса\ тела\)), стартуешь тренировки по заранее сохранённым планам-шаблонам, и ставишь цели "достичь X к дате" на каждое упражнение.

### Цели (MVP)
- **Быстрый ввод в зале**: упражнения и подходы (вес/повторы) без лишних экранов
- **Прогресс по упражнениям**: график 1RM по датам
- **Сравнение с друзьями**: 1RM в двух режимах — абсолют и \(1RM/масса\ тела\)
- **Планы тренировок (шаблоны)**: заранее собрать тренировку и стартовать в 1 тап
- **Цель на упражнение**: по одной активной цели на каждое упражнение (target 1RM + дата, без программ и рекомендаций)

### Основные сценарии
- **S1 Лог тренировки**: Start → добавить упражнение → добавить подходы (вес/повторы) → Finish
- **S2 Прогресс**: открыть упражнение → график 1RM → переключатель absolute/ratio
- **S3 Сравнение**: открыть друга → выбрать упражнение → график "я vs друг" → absolute/ratio
- **S4 План**: открыть план → Start → сразу активная тренировка с упражнениями и предзаполненными подходами
- **S5 Цель**: задать цель на упражнение (target/date) → смотреть список целей с прогрессом; либо через Exercise Detail → "Поставить цель"

### Информационная модель (минимум данных)
- **User**: id, name, handle
- **Friendship**: fromUserId, toUserId, status(pending/accepted)
- **BodyWeightEntry**: userId, date, weightKg
- **Exercise**: id, name
- **Workout**: id, userId, startedAt, finishedAt?
- **WorkoutExercise**: workoutId, exerciseId, order
- **SetEntry**: workoutExerciseId, order, weightKg, reps
- **WorkoutPlan**: id, userId, name, updatedAt
- **PlanExercise**: planId, exerciseId, order, plannedSetCount?
  - Примечание: веса в плане не фиксируем — подтягиваем "как в прошлый раз".

### Логика и правила расчётов
- **Формула 1RM** (Epley, одна на весь продукт):
  - \(1RM = w \cdot (1 + reps/30)\)
- **Точка на графике упражнения**: максимум 1RM среди подходов упражнения в конкретной тренировке.
- **Ratio**: \(1RM / bodyWeight\)
  - bodyWeight = последняя запись массы тела на дату тренировки или раньше.
  - если массы нет — ratio скрываем и показываем CTA "добавь массу тела".
- **Prefill при старте плана**:
  - упражнения/подходы создаются из плана (по plannedSetCount)
  - веса/повторы предзаполняются "как в прошлый раз" (последняя тренировка по этому упражнению)
  - пользователь правит на месте во время тренировки

### Навигация
Tab-bar: **Plans | Friends | Goal | Profile**
- FAB "Start empty workout" — на экране Plans
- Exercise Detail — открывается тапом на упражнение из Active Workout и из friend detail

### Экраны (MVP)
- **Active Workout**
  - список упражнений
  - под упражнением — строки подходов (weight/reps), "+ подход"
  - Finish workout
- **Exercise Detail**
  - график 1RM
  - переключатель absolute/ratio
  - история тренировок списком (с лучшим подходом/1RM)
- **Plans**
  - FAB → Start empty workout
  - список планов
  - plan detail: упражнения + plannedSetCount + порядок
  - Start plan → Active Workout
- **Friends**
  - add friend (handle)
  - список друзей
  - friend detail: выбор упражнения + график сравнения "я vs друг" (2 линии), absolute/ratio
- **Goal**
  - список активных целей (по одной на упражнение)
  - каждая карточка: exercise + target 1RM + target date + current 1RM + remainingKg + прогресс-бар
  - при current 1RM ≥ target: показываем "Достигнуто", предлагаем поставить новую цель
  - добавить цель можно со вкладки Goal (выбор упражнения) или из Exercise Detail ("Поставить цель")
- **Profile/Settings**
  - единицы (только kg)
  - масса тела: добавить запись (date + weight)

### Граничные кейсы
- **Active Workout прервана**: при сворачивании/закрытии приложения тренировка сохраняется как незавершённая и восстанавливается при следующем открытии.

### Приватность (MVP)
- Друзья видят метрики по упражнениям (1RM и ratio).
- Масса тела как число **не обязана** отображаться друзьям (используется только для расчёта ratio).

---

## Scope

### Must (обязательно)
- Лог тренировки: упражнения + подходы (вес/повторы), завершение тренировки.
- История упражнения: график 1RM.
- Два режима: absolute и \(1RM/масса\ тела\).
- Друзья: добавить/принять, профиль друга, сравнение "я vs друг" по упражнению.
- Планы: создать/редактировать (упражнения + число подходов), Start → активная тренировка.
- Prefill "как в прошлый раз" при старте плана.
- Масса тела: добавить запись (дата+вес).
- Цель: активная цель на каждое упражнение (exercise/target/date) + "осталось X кг".

### Будущие доработки
- Workout Detail: тап на тренировку в истории Exercise Detail → экран с полным списком подходов той тренировки.