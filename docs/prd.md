## Gorilla Progress — PRD

### One-liner
Приложение, где ты быстро логируешь силовые тренировки, видишь графики 1RM, сравниваешь 1RM с друзьями (абсолют и \(1RM/масса\ тела\)), стартуешь тренировки по заранее сохранённым планам-шаблонам, и ведёшь простую цель “достичь X к дате”.

### Цели (MVP)
- **Быстрый ввод в зале**: упражнения и подходы (вес/повторы) без лишних экранов
- **Прогресс по упражнениям**: график 1RM по датам
- **Сравнение с друзьями**: 1RM в двух режимах — абсолют и \(1RM/масса\ тела\)
- **Планы тренировок (шаблоны)**: заранее собрать тренировку и стартовать в 1 тап
- **Цель на 3 месяца**: упражнение + target 1RM + дата (без программ и рекомендаций)

### Основные сценарии
- **S1 Лог тренировки**: Start → добавить упражнение → добавить подходы (вес/повторы) → Finish
- **S2 Прогресс**: открыть упражнение → график 1RM → переключатель absolute/ratio
- **S3 Сравнение**: открыть друга → выбрать упражнение → график “я vs друг” → absolute/ratio
- **S4 План**: открыть план → Start → сразу активная тренировка с упражнениями и предзаполненными подходами
- **S5 Цель**: задать цель (exercise/target/date) → смотреть “сколько осталось” и прогресс-бар

### Информационная модель (минимум данных)
- **User**: id, name, handle, avatarUrl?
- **Friendship**: fromUserId, toUserId, status(pending/accepted)
- **BodyWeightEntry**: userId, date, weightKg
- **Exercise**: id, name, isCustom, ownerUserId?
- **Workout**: id, userId, startedAt, finishedAt?, note?
- **WorkoutExercise**: workoutId, exerciseId, order
- **SetEntry**: workoutExerciseId, order, weightKg, reps
- **WorkoutPlan**: id, userId, name, updatedAt
- **PlanExercise**: planId, exerciseId, order, plannedSetCount?
  - Примечание: веса в плане по умолчанию не фиксируем — подтягиваем “как в прошлый раз”.

### Логика и правила расчётов
- **Формула 1RM**: одна на весь продукт (например Epley):
  - \(1RM = w \cdot (1 + reps/30)\)
- **Точка на графике упражнения**: максимум 1RM среди подходов упражнения в конкретной тренировке.
- **Ratio**: \(1RM / bodyWeight\)
  - bodyWeight = последняя запись массы тела на дату тренировки или раньше.
  - если массы нет — ratio скрываем и показываем CTA “добавь массу тела”.
- **Prefill при старте плана**:
  - упражнения/подходы создаются из плана (по plannedSetCount)
  - веса/повторы предзаполняются “как в прошлый раз” (последняя тренировка по этому упражнению)
  - пользователь правит на месте во время тренировки

### Экраны (MVP)
- **Home/Today**
  - Start last plan
  - Plans
  - Start empty workout
- **Active Workout**
  - список упражнений
  - под упражнением — строки подходов (weight/reps), “+ подход”
  - Finish workout
- **Exercise Detail**
  - график 1RM
  - переключатель absolute/ratio
  - история тренировок списком (с лучшим подходом/1RM)
- **Plans**
  - список планов
  - create plan (пустой / из последней тренировки) — желательно
  - plan detail: упражнения + plannedSetCount + порядок
  - Start plan → Active Workout
  - после завершения тренировки — “обновить план по факту” — желательно
- **Friends**
  - add friend (1 способ: handle или инвайт-ссылка — выбрать один)
  - список друзей
  - friend detail:
    - выбор упражнения
    - график сравнения “я vs друг” (2 линии), absolute/ratio
- **Goal**
  - 1 активная цель: exercise + target 1RM + target date
  - отображение: current 1RM, remainingKg, прогресс-бар
- **Settings/Profile**
  - единицы (kg/lb)
  - масса тела: добавить запись (date + weight)
  - (опционально) выбор формулы 1RM, если нужно

### Приватность (MVP)
- Друзья видят метрики по упражнениям (1RM и ratio).
- Масса тела как число **не обязана** отображаться друзьям (используется для расчёта ratio).

### Analytics (минимально)
- Среднее время добавления подхода
- D7 retention
- % тренировок, начатых по плану
- % пользователей с заполненной массой тела
- Кол-во сравнений с друзьями в неделю

### Приёмка (high-level)
- Тренировка по плану стартует в 1 тап и сразу показывает упражнения/подходы.
- График 1RM корректен и одинаково считается у тебя и у друга.
- Переключатель absolute/ratio работает на упражнении и в сравнении с другом.
- При отсутствии массы тела ratio не ломает UI и просит добавить вес.

---

## Scope

### Must (обязательно)
- Лог тренировки: упражнения + подходы (вес/повторы), завершение тренировки.
- История упражнения: график 1RM.
- Два режима: absolute и \(1RM/масса\ тела\).
- Друзья: добавить/принять, профиль друга, сравнение “я vs друг” по упражнению.
- Планы: создать/редактировать (упражнения + число подходов), Start → активная тренировка.
- Prefill “как в прошлый раз” при старте плана и при добавлении упражнения.
- Масса тела: добавить запись (дата+вес).
- Цель: 1 активная цель (exercise/target/date) + “осталось X кг”.
