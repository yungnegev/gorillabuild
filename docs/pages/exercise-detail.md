# Exercise Detail

**Роут:** `exercise/[id]`

## Назначение

Экран истории и прогресса по конкретному упражнению. Показывает график 1RM и список тренировок.

## Сценарий (S2)

Открыть упражнение → график 1RM → переключатель absolute/ratio

## Как открывается

- Тап на упражнение из Active Workout
- Тап на упражнение из Friend Detail

## Содержимое экрана

- График 1RM по датам
- Переключатель режимов: **absolute** / **ratio**
- История тренировок списком — каждая запись содержит лучший подход и рассчитанный 1RM

## Режимы графика

### Absolute
Ось Y — значение 1RM в кг.

### Ratio
Ось Y — \(1RM / bodyWeight\).

- `bodyWeight` = последняя запись `BodyWeightEntry` на дату тренировки или раньше
- Если записи массы тела нет — режим ratio скрыт, показывается CTA "добавь массу тела"

## Формула 1RM

Epley: \(1RM = w \cdot (1 + reps / 30)\)

Точка на графике = максимум 1RM среди всех подходов упражнения в конкретной тренировке.

## Цель по упражнению

Если на это упражнение есть активная цель, под графиком показывается блок цели:

- Target 1RM, target date
- Current 1RM и `remainingKg`
- Прогресс-бар
- Кнопка "Изменить цель"

Если цели нет — кнопка "Поставить цель" (ведёт на форму в `(tabs)/goal` с предзаполненным упражнением).

## Модель данных

| Сущность | Поля |
|----------|------|
| `Exercise` | `id`, `name` |
| `SetEntry` | `workoutExerciseId`, `order`, `weightKg`, `reps` |
| `BodyWeightEntry` | `userId`, `date`, `weightKg` |
| `Goal` | `exerciseId`, `targetOneRm`, `targetDate`, `isActive` |

## Уточнения (веб)

- При отсутствии завершённых тренировок с этим упражнением показывается пустое состояние (график не рисуется).
- В режиме ratio, если записей массы тела на даты тренировок нет, показывается сообщение с призывом добавить вес в профиле.
- «Поставить цель» ведёт на `/goal?exerciseId=...` (форма с предзаполненным упражнением).
- «Изменить цель» ведёт на `/goal`.
- Открытие из Friend Detail: переход на Exercise Detail доступен из Active Workout. В Friend Detail упражнения раскрываются inline с графиком сравнения.
